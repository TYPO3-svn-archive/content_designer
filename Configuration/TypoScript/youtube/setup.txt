tt_content.tx_contentdesigner_youtube < plugin.tx_contentdesigner
tt_content.tx_contentdesigner_youtube.settings {
  title       = LLL:EXT:content_designer/Resources/Private/Language/locallang_db.xml:youtube_title
  description = LLL:EXT:content_designer/Resources/Private/Language/locallang_db.xml:youtube_description
  
  icon      = ../typo3conf/ext/content_designer/Resources/Public/Icons/MediaElementJS/ce_wiz.gif
  iconSmall = ../typo3conf/ext/content_designer/Resources/Public/Icons/MediaElementJS/ext_icon.gif
  
  previewObj = COA
  previewObj {
		20            = TEXT
		20.field      = url
		20.wrap       = <p><strong>Video ID:</strong>&nbsp;|</p>
		20.replacement.10 {
			# Make it flexible
			useRegExp = 1
			search = /^.*[^"?].*(v=|embed\/|v\/|youtu.be\/)([^"?&]+)/i
			replace = $2
		}
  }
  
  cObject {
    sDEF {
      sheetTitle = LLL:EXT:content_designer/Resources/Private/Language/locallang_db.xml:sheet_general
      
      el.url {
        label = URL
        config.type = input
      }
	  
	  el.start {
	    label = LLL:EXT:content_designer/Resources/Private/Language/locallang_db.xml:youtube_starttime
		config.type = input
	  }
    }
  }
  
  renderObj {
    wrap = <div class="tx_contentdesigner_youtube">|</div>
    
		20 = TEXT
    20.value = {$styles.content.imgtext.maxW}
    20.noTrimWrap = |<div class="video"><iframe width="|" |
    
    30 = TEXT
    30.value = {$styles.content.imgtext.maxW}-200
    30.prioriCalc = 1
    30.dataWrap = height="|"
	
		40 = TEXT
		40.field = url
		40.noTrimWrap = | src="//www.youtube.com/embed/|" allowfullscreen></iframe></div>|
		40.replacement < tt_content.tx_contentdesigner_youtube.settings.previewObj.20.replacement
		
		# Append the Starttime
		40.innerWrap.cObject = TEXT
		40.innerWrap.cObject {
			value = |?start={field:start}
			if.isTrue.field = start
			insertData = 1
		}
  }
}